# Triton-YOLO Inference Server

Этот проект представляет собой готовое, контейнеризированное решение для запуска моделей детекции и сегментации YOLO с использованием NVIDIA Triton Inference Server и шлюза на FastAPI.

## Обзор

Производственный пайплайн для инференса, который объединяет:
*   **Модели детекции и сегментации YOLO**
*   **NVIDIA Triton Inference Server** для оптимизированного обслуживания моделей
*   **Шлюз FastAPI** с REST API эндпоинтами
*   **Docker-контейнеры** для простого развертывания
*   **Ансамблевую модель**, объединяющую детекцию и сегментацию

## Структура проекта
```
┌── Dockerfile                  # Определение контейнера для шлюза FastAPI
├── docker-compose.yml          # Оркестрация мульти-контейнеров
├── main.py                     # FastAPI приложение с эндпоинтами
├── pyproject.toml              # Зависимости Python
├── poetry.lock                 # Фиксированные версии зависимостей
├── run_perf_from_container.sh  # Скрипт для тестирования производительности
├── .gitignore                  # Правила для Git
└── triton_models/              # Репозиторий моделей для Triton
    ├── yolo_det                # Модель детекции
    ├── yolo_seg                # Модель сегментации
    └── yolo_ensemble/          # Комбинированная модель (детекция + сегментация)
```
## Возможности

*   **Шлюз FastAPI**: REST эндпоинты для инференса и визуализации.
*   **Полная реализация NMS**: Non-Maximum Suppression для фильтрации bounding box'ов.
*   **Тестирование производительности**: Интеграция с `perf_analyzer` для бенчмаркинга.
*   **Docker-окружение**: Простое развертывание с помощью Docker Compose.
*   **Визуализация результатов**: Эндпоинт для отображения результатов детекции.
<img width="1050" height="888" alt="image" src="https://github.com/user-attachments/assets/86cfe6a9-d4e8-4527-9ea1-d1495a0e3877" />


## Быстрый старт

### Предварительные требования
*   Docker и Docker Compose
*   GPU NVIDIA с драйверами (опционально, для ускорения на GPU)

### Установка

1.  Клонируйте репозиторий:
    ```bash
    git clone https://github.com/Aleksandr-Tokmashov/triton-yolo-project.git
    cd triton-yolo-project
    ```

2.  Соберите и запустите сервисы:
    ```bash
    docker-compose up --build
    ```

3.  Шлюз FastAPI будет доступен по адресу: `http://localhost:8080`

## Тестирование производительности

Запустите анализ производительности с помощью встроенного скрипта:
```bash
./run_perf_from_container.sh
```
## Эндпоинты API
- `POST /predict` — Запустить инференс на входных изображениях.
- `GET /visualize` — Получить визуализацию результатов детекции.
- Эндпоинты для проверки здоровья (health check) и мониторинга.

